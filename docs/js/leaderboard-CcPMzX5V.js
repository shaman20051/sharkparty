import{c as t,a as l,b as e,t as d,F as g,g as w,i as C,h as f,j as E,l as I,r as N,o as V,k as F,d as A}from"./script-Bpn8pEW9.js";const M={class:"leaderboard-details"},J={class:"leaderboards-grid__cell leaderboards-grid__cell--details"},O={class:"leaderboard-header"},q={class:"leaderboard-header__title"},G={class:"leaderboard-header__period"},H={class:"leaderboard-conditions"},K={class:"leaderboard-conditions__text"},Q={class:"leaderboard-conditions__tournaments"},R={class:"leaderboard-conditions__list"},U={href:"#",class:"leaderboard-conditions__link"},W={class:"leaderboard-table"},X={class:"leaderboard-grid"},Y={class:"leaderboard-grid__row leaderboard-grid__row--player"},Z={class:"leaderboard-grid__cell leaderboard-grid__cell--number"},ee={class:"leaderboard-grid__cell leaderboard-grid__cell--player"},ae={class:"leaderboard-grid__cell leaderboard-grid__cell--player"},re={class:"leaderboard-grid__cell leaderboard-grid__cell--points"},de={class:"leaderboard-grid__cell leaderboard-grid__cell--details"},le=["onClick","aria-expanded"],se={class:"leaderboard-grid__row leaderboard-grid__row--tournaments"},te={class:"leaderboard-grid__cell leaderboard-grid__cell--full",colspan:"4"},oe={class:"player-tournaments"},ne={class:"player-tournaments__cell player-tournaments__cell--number"},ie={class:"player-tournaments__cell player-tournaments__cell--name"},_e={href:"#",class:"player-tournaments__link"},ce={class:"player-tournaments__cell player-tournaments__cell--place"},be={class:"player-tournaments__cell player-tournaments__cell--prize"},ue={class:"player-tournaments__cell player-tournaments__cell--points"},me={__name:"Leaderboard",props:{leaderboard:Object},setup(n){return(b,r)=>(l(),t("div",M,[e("div",J,[e("button",{class:"leaderboards-grid__details-link",onClick:r[0]||(r[0]=a=>b.$emit("back"))}," Список лидербордов ")]),e("div",O,[e("h2",q,'Лидерборд "'+d(n.leaderboard.leaderboardName)+'"',1),e("div",G,d(new Date(n.leaderboard.startTime).toLocaleDateString())+" - "+d(new Date(n.leaderboard.endTime).toLocaleDateString()),1)]),e("div",H,[r[2]||(r[2]=e("h3",{class:"leaderboard-conditions__title"},"Условия проведения:",-1)),e("p",K,d(n.leaderboard.info),1),e("div",Q,[r[1]||(r[1]=e("h4",{class:"leaderboard-conditions__subtitle"},"Турниры лидерборда:",-1)),e("ul",R,[(l(!0),t(g,null,w(n.leaderboard.tournaments||[],a=>(l(),t("li",{class:"leaderboard-conditions__item",key:a.tournamentName},[e("a",U,"Турнир "+d(a.tournamentName),1),C(" "+d(new Date(a.startTime).toLocaleString()),1)]))),128))])])]),e("div",W,[e("div",X,[r[4]||(r[4]=f('<div class="leaderboard-grid__header leaderboard-grid__row"><div class="leaderboard-grid__cell leaderboard-grid__cell--number">№</div><div class="leaderboard-grid__cell leaderboard-grid__cell--player">Игрок</div><div class="leaderboard-grid__cell leaderboard-grid__cell--player">Страна</div><div class="leaderboard-grid__cell leaderboard-grid__cell--points">Очки</div><div class="leaderboard-grid__cell leaderboard-grid__cell--details"></div></div>',1)),(l(!0),t(g,null,w(n.leaderboard.players||[],(a,_)=>(l(),t(g,{key:a.nickname},[e("div",Y,[e("div",Z,d(_+1),1),e("div",ee,d(a.nickname),1),e("div",ae,d(a.country),1),e("div",re,d(a.totalPoints.toFixed(2)),1),e("div",de,[e("button",{class:"leaderboard-grid__details-btn",onClick:i=>a.show=!a.show,"aria-expanded":a.show}," Подробнее ",8,le)])]),E(e("div",se,[e("div",te,[e("div",oe,[r[3]||(r[3]=f('<div class="player-tournaments__header player-tournaments__row"><div class="player-tournaments__cell player-tournaments__cell--number">№</div><div class="player-tournaments__cell player-tournaments__cell--name">Турнир</div><div class="player-tournaments__cell player-tournaments__cell--place">Место</div><div class="player-tournaments__cell player-tournaments__cell--prize">Призовые</div><div class="player-tournaments__cell player-tournaments__cell--points">Очки</div></div>',1)),(l(!0),t(g,null,w(a.tournaments,(i,o)=>(l(),t("div",{class:"player-tournaments__row",key:o},[e("div",ne,d(o+1),1),e("div",ie,[e("a",_e,d(i.tournamentName)+" "+d(new Date(i.startTime).toLocaleString()),1)]),e("div",ce,d(i.place),1),e("div",be,d(i.prize.toFixed(2)),1),e("div",ue,d(i.points.toFixed(2)),1)]))),128))])])],512),[[I,a.show]])],64))),128))])])]))}},ve={class:"leaderboards-list"},ge={class:"leaderboards-grid"},pe={class:"leaderboards-grid__cell leaderboards-grid__cell--number"},he={class:"leaderboards-grid__cell leaderboards-grid__cell--name"},ye={class:"leaderboards-grid__cell leaderboards-grid__cell--period"},we={class:"leaderboards-grid__cell leaderboards-grid__cell--details"},ke=["onClick"],$e={__name:"LeaderboardList",props:{leaderboards:Array},setup(n){return(b,r)=>(l(),t("div",ve,[r[1]||(r[1]=e("h2",{class:"leaderboards-list__title"},"Список лидербордов",-1)),e("div",ge,[r[0]||(r[0]=f('<div class="leaderboards-grid__header leaderboards-grid__row"><div class="leaderboards-grid__cell leaderboards-grid__cell--number">№</div><div class="leaderboards-grid__cell leaderboards-grid__cell--name">Название</div><div class="leaderboards-grid__cell leaderboards-grid__cell--period">Срок проведения</div><div class="leaderboards-grid__cell leaderboards-grid__cell--details"></div></div>',1)),(l(!0),t(g,null,w(n.leaderboards,(a,_)=>(l(),t("div",{class:"leaderboards-grid__row",key:a.leaderboardName},[e("div",pe,d(_+1),1),e("div",he,d(a.leaderboardName),1),e("div",ye,d(new Date(a.startTime).toLocaleDateString())+" - "+d(new Date(a.endTime).toLocaleDateString()),1),e("div",we,[e("button",{class:"leaderboards-grid__details-link",onClick:i=>b.$emit("selectLeaderboard",a)}," Подробнее ",8,ke)])]))),128))])]))}},fe={class:"leaderboards-section"},De={__name:"LeaderboardPage",setup(n){const b=N([]),r=N(null),a="/sharkparty/",_=async o=>{const c=await fetch(o);if(!c.ok)throw new Error(`Failed to load ${o}`);return c.json()};V(async()=>{const o=await _(`${a}data/index_leaderboard.json`),c=await Promise.all(o.map(async D=>{const p=await _(`${a}data/${D}`),S=p.indexFiles||"index_tournament.json",P=await _(`${a}data/${S}`),L=(await Promise.all(P.map(s=>_(`${a}data/${s}`)))).filter(s=>{const u=new Date(s.startTime);return u>=new Date(p.startTime)&&u<=new Date(p.endTime)&&s.info.buyIn>=1}),m={};L.forEach(s=>{const u=s.info.buyIn;s.players.forEach(k=>{const h=k.rank,$=s.prize.find(y=>{if(typeof y.place=="string"&&y.place.includes("-")){const[z,B]=y.place.split("-").map(Number);return h>=z&&h<=B}return Number(y.place)===h}),x=($==null?void 0:$.prize)??0,T=+(x/u).toFixed(2),v=k.player.nickname;m[v]||(m[v]={nickname:v,country:k.player.country,totalPoints:0,tournaments:[]}),m[v].totalPoints+=T,m[v].tournaments.push({tournamentName:s.tournamentName,startTime:s.startTime,place:h,prize:x,points:T})})});const j=Object.values(m).sort((s,u)=>u.totalPoints-s.totalPoints);return{...p,tournaments:L,players:j}}));b.value=c});function i(o){r.value=o}return(o,c)=>(l(),t("section",fe,[r.value?(l(),F(me,{key:1,leaderboard:r.value,onBack:c[0]||(c[0]=D=>r.value=null)},null,8,["leaderboard"])):(l(),F($e,{key:0,leaderboards:b.value,onSelectLeaderboard:i},null,8,["leaderboards"]))]))}};A(De).mount("#leaderboard-app");
